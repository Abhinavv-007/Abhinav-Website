<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Anya's Scholarship Finder</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg-light: #fdf2f8; /* Light Pink */
            --bg-dark: #1e293b;  /* Dark Blue */
            --text-light-primary: #1f2937;
            --text-light-secondary: #6b7280;
            --text-dark-primary: #e0e7ff;
            --text-dark-secondary: #94a3b8;
            --card-bg-light: #ffffff;
            --card-bg-dark: #334155;
            --border-light: #f3f4f6;
            --border-dark: #475569;
            --accent-color: #ec4899; /* Pink */
            --secondary-accent-color: #60a5fa; /* Blue */
        }
        html.dark { color-scheme: dark; }
        body {
            font-family: 'Poppins', sans-serif;
            background-color: var(--bg-light);
            color: var(--text-light-primary);
            transition: background-color 0.3s, color 0.3s;
        }
        .dark body {
            background-color: var(--bg-dark);
            color: var(--text-dark-primary);
        }
        .custom-scrollbar::-webkit-scrollbar { height: 4px; width: 8px; }
        .custom-scrollbar::-webkit-scrollbar-track { background: transparent; }
        .custom-scrollbar::-webkit-scrollbar-thumb { background: #d1d5db; border-radius: 10px; }
        .dark .custom-scrollbar::-webkit-scrollbar-thumb { background: #4b5563; }
        .modal-card-height { max-height: 90vh; }
        .scholarship-card {
            background-color: var(--card-bg-light);
            border: 1px solid var(--border-light);
            border-radius: 1.5rem;
        }
        .dark .scholarship-card {
            background-color: var(--card-bg-dark);
            border: 1px solid var(--border-dark);
        }
        .gradient-text {
            background: linear-gradient(to right, #ec4899, #60a5fa);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            animation: subtle-glow 4s ease-in-out infinite;
        }
        .dark .gradient-text {
            background: linear-gradient(to right, #f9a8d4, #93c5fd);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        .loader {
            border: 4px solid #f3f3f3;
            border-top: 4px solid var(--accent-color);
            border-radius: 50%;
            width: 32px;
            height: 32px;
            animation: spin 1s linear infinite;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        .ai-button {
            background-image: linear-gradient(to right, #ec4899 0%, #60a5fa 51%, #ec4899 100%);
            background-size: 200% auto;
            transition: background-position 0.5s;
        }
        .ai-button:hover {
            background-position: right center;
        }
        @keyframes subtle-glow {
            0%, 100% { filter: drop-shadow(0 0 3px rgba(236, 72, 153, 0.4)); }
            50% { filter: drop-shadow(0 0 8px rgba(96, 165, 250, 0.4)); }
        }
        html:not(.dark) #ai-tips-modal .text-text-light-primary,
        html:not(.dark) #ai-tips-modal .dark\:text-text-dark-primary,
        html:not(.dark) #ai-tips-modal .text-text-light-secondary,
        html:not(.dark) #ai-tips-modal .dark\:text-text-dark-secondary,
        html:not(.dark) #ai-tips-modal .text-blue-500,
        html:not(.dark) #ai-tips-modal h2,
        html:not(.dark) #ai-tips-modal p,
        html:not(.dark) #ai-tips-modal li {
            color: white !important;
        }
        .dark #scholarship-list h3 {
            color: white;
        }
        #scholarship-list h3 {
            color: black;
        }
         .typing-indicator span {
            height: 8px;
            width: 8px;
            background-color: var(--text-light-secondary);
            border-radius: 50%;
            display: inline-block;
            animation: bounce 1.4s infinite ease-in-out both;
        }
        .dark .typing-indicator span {
            background-color: var(--text-dark-secondary);
        }
        .typing-indicator span:nth-child(1) { animation-delay: -0.32s; }
        .typing-indicator span:nth-child(2) { animation-delay: -0.16s; }
        @keyframes bounce {
            0%, 80%, 100% { transform: scale(0); }
            40% { transform: scale(1.0); }
        }
    </style>
</head>
<body class="antialiased">

    <div id="app" class="w-full px-4 md:px-8 lg:px-16">
        
        <header class="text-center mb-10 relative pt-8">
            <h1 class="text-4xl md:text-5xl font-bold mb-2 gradient-text">Anya's Scholarship Finder</h1>
            <p class="text-lg text-gray-600 dark:text-gray-400">Your Personal Guide to Humanities Scholarships for 2026</p>
            <button id="theme-toggle" class="absolute top-4 right-4 p-2 rounded-full text-gray-500 dark:text-gray-400 hover:bg-pink-100 dark:hover:bg-slate-700 transition-colors">
                <svg id="theme-toggle-dark-icon" class="w-6 h-6 hidden" fill="currentColor" viewBox="0 0 20 20"><path d="M17.293 13.293A8 8 0 016.707 2.707a8.001 8.001 0 1010.586 10.586z"></path></svg>
                <svg id="theme-toggle-light-icon" class="w-6 h-6 hidden" fill="currentColor" viewBox="0 0 20 20"><path d="M10 2a1 1 0 011 1v1a1 1 0 11-2 0V3a1 1 0 011-1zm4 8a4 4 0 11-8 0 4 4 0 018 0zm-.464 4.95l.707.707a1 1 0 001.414-1.414l-.707-.707a1 1 0 00-1.414 1.414zm2.12-10.607a1 1 0 010 1.414l-.706.707a1 1 0 11-1.414-1.414l.707-.707a1 1 0 011.414 0zM17 11a1 1 0 100-2h-1a1 1 0 100 2h1zm-7 4a1 1 0 011 1v1a1 1 0 11-2 0v-1a1 1 0 011-1zM5.05 5.05A1 1 0 003.636 6.464l.707.707a1 1 0 001.414-1.414l-.707-.707zM3 11a1 1 0 100-2H2a1 1 0 100 2h1zM13.536 14.95a1 1 0 010-1.414l.707-.707a1 1 0 011.414 1.414l-.707.707a1 1 0 01-1.414 0z"></path></svg>
            </button>
        </header>

        <div class="text-center mb-8">
            <button id="open-ask-ai-modal-btn" class="ai-button text-white font-bold py-3 px-6 rounded-lg shadow-lg hover:shadow-xl transition-all">
                ðŸ¤–ðŸ’¬ UniWhiz â€“ Your Smart Admissions Guide
            </button>
        </div>

        <main>
            <section id="scholarship-section">
                <div id="scholarship-list" class="space-y-12"></div>
            </section>
        </main>
    </div>

    <div id="ai-tips-modal" class="fixed inset-0 bg-black bg-opacity-70 z-50 hidden items-center justify-center p-4 backdrop-blur-sm">
        <div class="bg-card-bg-light/80 dark:bg-card-bg-dark/80 backdrop-blur-lg rounded-2xl shadow-2xl w-full max-w-2xl modal-card-height flex flex-col border border-white/20 dark:border-border-dark">
             <div class="p-6 border-b border-white/20 dark:border-border-dark flex justify-between items-start">
                <div>
                    <h2 id="ai-tips-title" class="text-3xl font-bold text-text-light-primary dark:text-text-dark-primary">AI Application Tips</h2>
                </div>
                <button id="close-ai-tips-modal" class="text-gray-500 hover:text-red-600 dark:text-gray-400 dark:hover:text-red-500 transition-colors text-3xl font-bold">&times;</button>
            </div>
            <div id="ai-tips-content" class="p-6 flex-1 overflow-y-auto custom-scrollbar space-y-4">
                <!-- AI Tips will be appended here -->
            </div>
        </div>
    </div>
    
    <div id="ask-ai-modal" class="fixed inset-0 bg-black bg-opacity-70 z-50 hidden items-center justify-center p-4 backdrop-blur-sm">
        <div class="bg-card-bg-light dark:bg-card-bg-dark rounded-2xl shadow-2xl w-full max-w-2xl modal-card-height flex flex-col border border-border-light dark:border-border-dark">
             <div class="p-6 border-b border-border-light dark:border-border-dark flex justify-between items-start">
                <div>
                    <h2 class="text-3xl font-bold text-text-light-primary dark:text-text-dark-primary">UniWhiz</h2>
                    <p class="text-md text-text-light-secondary dark:text-text-dark-secondary">Hey there! I'm UniWhiz â€” Anya's smart university helper ðŸ¤–ðŸ’¬</p>
                </div>
                <button id="close-ask-ai-modal" class="text-gray-500 hover:text-red-600 dark:text-gray-400 dark:hover:text-red-500 transition-colors text-3xl font-bold">&times;</button>
            </div>
            <div id="ai-chat-box" class="p-6 flex-1 overflow-y-auto custom-scrollbar space-y-4">
                <!-- Chat messages will be appended here -->
            </div>
            <div class="p-6 border-t border-border-light dark:border-border-dark">
                <div id="ai-thinking-indicator" class="hidden mb-2 flex items-center space-x-2">
                    <span class="text-gray-500 dark:text-gray-400">UniWhiz is thinking...</span>
                    <div class="typing-indicator"><span></span><span></span><span></span></div>
                </div>
                <div id="ai-input-container" class="flex space-x-2">
                    <input type="text" id="ai-question-input" class="w-full p-3 border border-gray-300 dark:border-gray-600 rounded-xl bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 focus:outline-none focus:ring-2 focus:ring-pink-400 transition-shadow" placeholder="Type your question about university applicationsâ€¦">
                    <button id="send-ai-question" class="ai-button text-white font-bold py-2 px-4 rounded-lg hover:shadow-xl transition-all">Send</button>
                </div>
            </div>
        </div>
    </div>

    <footer class="text-center py-8 mt-8 border-t border-gray-200 dark:border-gray-700">
        <p class="text-gray-600 dark:text-gray-400">A special creation for Anya, from Abhinav.
        </p>
    </footer>

    <script>
        const scholarshipData = [
            { university: 'Sciences Po', country: 'France', scholarships: [
                { name: 'Emile Boutmy Scholarship', category: 'Merit-Based', value: 'â‚¬3,900 to â‚¬14,210 per year', eligibility: 'Top non-EU students admitted to undergraduate programs.', link: 'https://www.sciencespo.fr/students/en/fees-funding/financial-aid/emile-boutmy-scholarship', uniId: 'sciencespo' },
                { name: 'Eiffel Scholarship Program of Excellence', category: 'Merit-Based', value: 'Monthly allowance (for Master\'s)', eligibility: 'Outstanding international candidates for Master\'s programs (relevant for future studies).', link: 'https://www.campusfrance.org/en/eiffel-scholarship-program-of-excellence', uniId: 'sciencespo' }
            ]},
            { university: 'Bocconi University', country: 'Italy', scholarships: [
                { name: 'Bocconi International Award', category: 'Merit-Based', value: '50% tuition waiver', eligibility: 'Outstanding international students based on academic profile.', link: 'https://www.unibocconi.eu/bocconi-international-award', uniId: 'bocconi' },
                { name: 'Bocconi Scholarship for International Students', category: 'Need-Based', value: 'Full tuition waiver', eligibility: 'Based on family\'s economic condition.', link: 'https://www.unibocconi.eu/fees', uniId: 'bocconi' }
            ]},
            { university: 'National University of Singapore (FASS)', country: 'Singapore', scholarships: [
                { name: 'ASEAN Undergraduate Scholarship', category: 'Merit-Based', value: 'Full tuition fees + living allowance', eligibility: 'Citizens of ASEAN member countries (excluding Singapore).', link: 'https://www.nus.edu.sg/oam/scholarships/freshmen-scholars/asean-undergraduate-scholarship-(aus)', uniId: 'nus_fass' },
                { name: 'Science & Technology Undergraduate Scholarship', category: 'Merit-Based', value: 'Full tuition fees + living allowance', eligibility: 'Citizens of Asian countries (excluding Singapore).', link: 'https://www.nus.edu.sg/oam/scholarships/freshmen-scholars/science-technology-undergraduate-scholarship', uniId: 'nus_fass' }
            ]},
            { university: 'Australian National University (CASS)', country: 'Australia', scholarships: [
                { name: 'ANU Chancellorâ€™s International Scholarship', category: 'Merit-Based', value: '25% or 50% tuition fee reduction', eligibility: 'High-achieving international students. Automatically considered.', link: 'https://www.anu.edu.au/study/scholarships/find-a-scholarship/anu-chancellors-international-scholarship', uniId: 'anu_cass' }
            ]},
            { university: 'University of Amsterdam (PPE)', country: 'Netherlands', scholarships: [
                { name: 'Amsterdam Merit Scholarship', category: 'Merit-Based', value: 'Partial tuition waiver (varies)', eligibility: 'Outstanding non-EU/EEA students admitted to a degree program.', link: 'https://www.uva.nl/en/education/master-s/scholarships--tuition-fees/scholarships-and-loans/amsterdam-merit-scholarship/amsterdam-merit-scholarship.html', uniId: 'uva_ppe' }
            ]},
            { university: 'Trinity College Dublin (HSS)', country: 'Ireland', scholarships: [
                { name: 'Global Excellence Undergraduate Scholarships', category: 'Merit-Based', value: 'â‚¬1,000 to â‚¬5,000 tuition fee reduction', eligibility: 'High-achieving non-EU students.', link: 'https://www.tcd.ie/global/scholarships/undergraduate/', uniId: 'tcd_hss' }
            ]},
            { university: 'University of Helsinki (Social Sciences)', country: 'Finland', scholarships: [
                { name: 'University of Helsinki Scholarship Programme', category: 'Merit-Based', value: '100% tuition waiver + â‚¬5,000 relocation grant', eligibility: 'Excellent non-EU/EEA students.', link: 'https://www.helsinki.fi/en/admissions-and-education/apply-bachelors-and-masters-programmes/scholarships-and-student-life/scholarship-programme', uniId: 'helsinki_ss' }
            ]},
            { university: 'University of Auckland (Arts)', country: 'New Zealand', scholarships: [
                { name: 'University of Auckland International Student Excellence Scholarship', category: 'Merit-Based', value: 'Up to NZD $10,000 towards tuition', eligibility: 'New international undergraduate students with excellent academic records.', link: 'https://www.auckland.ac.nz/en/study/scholarships-and-awards/find-a-scholarship/university-of-auckland-international-student-excellence-scholarship-810-all.html', uniId: 'auckland_arts' }
            ]},
            { university: 'King\'s College London', country: 'UK', scholarships: [
                { name: 'King\'s International Scholarship', category: 'Merit-Based', value: 'Â£25,000 towards first year tuition', eligibility: 'Outstanding international students.', link: 'https://www.kcl.ac.uk/study/scholarships-and-funding/kings-international-scholarship', uniId: 'kcl_ppe' }
            ]},
            { university: 'ETH Zurich', country: 'Switzerland', scholarships: [
                { name: 'Excellence Scholarship & Opportunity Programme (ESOP)', category: 'Merit-Based', value: 'Full study and living costs', eligibility: 'Excellent students wishing to pursue a Masterâ€™s degree.', link: 'https://ethz.ch/students/en/studies/financial/scholarships/excellencescholarship.html', uniId: 'eth_zurich' }
            ]},
            { university: 'KU Leuven', country: 'Belgium', scholarships: [
                { name: 'Science@Leuven Scholarships', category: 'Merit-Based', value: 'Up to â‚¬10,000 for one year', eligibility: 'International students for Master\'s programs in science.', link: 'https://wet.kuleuven.be/international/scienceatleuvenscholarship', uniId: 'ku_leuven' }
            ]},
            { university: 'University of Padua', country: 'Italy', scholarships: [
                { name: 'Padua International Excellence Scholarship', category: 'Merit-Based', value: 'Full tuition waiver + â‚¬8,000/year', eligibility: 'Highly talented prospective international students.', link: 'https://www.unipd.it/en/scholarships', uniId: 'padua_psych' }
            ]},
            { university: 'Stockholm University', country: 'Sweden', scholarships: [
                { name: 'Stockholm University Scholarship Scheme', category: 'Merit-Based', value: 'Tuition fee waiver', eligibility: 'Primarily for Master\'s students from outside the EU/EEA.', link: 'https://www.su.se/english/education/fees-scholarships/scholarships', uniId: 'stockholm_ibp' }
            ]}
        ];

        let chatHistory = [];

        document.addEventListener('DOMContentLoaded', () => {
            setupTheme();
            renderScholarships();
            setupAiTipsModal();
            setupAskAiModal();
        });

        function setupTheme() {
            const themeToggle = document.getElementById('theme-toggle');
            const lightIcon = document.getElementById('theme-toggle-light-icon');
            const darkIcon = document.getElementById('theme-toggle-dark-icon');

            const applyTheme = (isDark) => {
                if (isDark) {
                    document.documentElement.classList.add('dark');
                    lightIcon.classList.add('hidden');
                    darkIcon.classList.remove('hidden');
                } else {
                    document.documentElement.classList.remove('dark');
                    darkIcon.classList.add('hidden');
                    lightIcon.classList.remove('hidden');
                }
            };

            const userPrefersDark = localStorage.getItem('theme') === 'dark' || 
                                    (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches && !localStorage.getItem('theme'));
            
            applyTheme(userPrefersDark);

            themeToggle.addEventListener('click', () => {
                const isDark = document.documentElement.classList.toggle('dark');
                localStorage.setItem('theme', isDark ? 'dark' : 'light');
                applyTheme(isDark);
            });
        }

        function renderScholarships() {
            const container = document.getElementById('scholarship-list');
            container.innerHTML = scholarshipData.map(uni => `
                <div>
                    <h3 class="text-2xl font-bold mb-4 text-black dark:text-white">${uni.university}</h3>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        ${uni.scholarships.map(scholarship => `
                            <div class="scholarship-card p-6 flex flex-col justify-between">
                                <div>
                                    <span class="inline-block bg-pink-100 text-pink-800 text-xs font-semibold mr-2 px-2.5 py-0.5 rounded-full dark:bg-pink-900 dark:text-pink-300">${scholarship.category}</span>
                                    <h4 class="text-xl font-bold my-2 text-text-light-primary dark:text-text-dark-primary">${scholarship.name}</h4>
                                    <p class="text-sm text-text-light-secondary dark:text-text-dark-secondary mb-2"><strong>Value:</strong> ${scholarship.value}</p>
                                    <p class="text-sm text-text-light-secondary dark:text-text-dark-secondary"><strong>Eligibility:</strong> ${scholarship.eligibility}</p>
                                </div>
                                <div class="mt-4 flex flex-col sm:flex-row space-y-2 sm:space-y-0 sm:space-x-2">
                                    <a href="${scholarship.link}" target="_blank" class="w-full text-center bg-blue-500 text-white font-semibold py-2 px-4 rounded-lg hover:bg-blue-600 transition-colors">Official Link</a>
                                    <button class="ai-tips-btn w-full ai-button text-white font-bold py-2 px-4 rounded-lg" data-scholarship-name="${scholarship.name}" data-uni-name="${uni.university}">AI Tips to Apply</button>
                                </div>
                            </div>
                        `).join('')}
                    </div>
                </div>
            `).join('');
            
            document.querySelectorAll('.ai-tips-btn').forEach(button => {
                button.addEventListener('click', () => {
                    const scholarshipName = button.dataset.scholarshipName;
                    const uniName = button.dataset.uniName;
                    generateAiTips(scholarshipName, uniName);
                });
            });
        }

        async function callGemini(prompt) {
            const payload = { contents: [{ role: "user", parts: [{ text: prompt }] }] };
            const apiKey = "AIzaSyB22uyhnAGZ1Wc0OBNMf8XnQZEB3eWSq7o"; 
            const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent?key=${apiKey}`;
            
            const response = await fetch(apiUrl, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(payload)
            });

            if (!response.ok) throw new Error(`API request failed with status ${response.status}`);
            
            const result = await response.json();

            if (result.candidates && result.candidates[0]?.content?.parts[0]?.text) {
                return result.candidates[0].content.parts[0].text;
            }
            throw new Error("Unexpected API response structure.");
        }

        async function generateAiTips(scholarshipName, uniName) {
            const modal = document.getElementById('ai-tips-modal');
            const contentContainer = document.getElementById('ai-tips-content');
            const title = document.getElementById('ai-tips-title');

            title.textContent = `AI Tips for ${scholarshipName}`;
            contentContainer.innerHTML = '<div class="loader mx-auto"></div>';
            modal.classList.remove('hidden');
            modal.classList.add('flex');

            const prompt = `You are an expert admissions and scholarship counselor. Provide a concise, bulleted list of actionable tips for a student applying to the "${scholarshipName}" at ${uniName}. Focus on what makes an application stand out for this specific scholarship. Include tips on the personal statement, letters of recommendation, and highlighting relevant experiences.`;

            try {
                const text = await callGemini(prompt);
                const formattedText = text.replace(/\*\*/g, '').replace(/\*\s/g, '').split('\n').filter(line => line.trim() !== '').map(line => `<li class="flex items-start py-1"><span class="mr-2 text-blue-500">ðŸ’¡</span><span>${line}</span></li>`).join('');
                contentContainer.innerHTML = `<ul class="space-y-2">${formattedText}</ul>`;
            } catch (error) {
                contentContainer.innerHTML = `<p class="text-red-500">Sorry, something went wrong while generating tips. Please try again later.</p>`;
            }
        }
        
        function setupAiTipsModal() {
            const modal = document.getElementById('ai-tips-modal');
            const closeBtn = document.getElementById('close-ai-tips-modal');
            
            closeBtn.addEventListener('click', () => modal.classList.add('hidden'));
            modal.addEventListener('click', (e) => { if (e.target === modal) modal.classList.add('hidden'); });
        }

        function setupAskAiModal() {
            const modal = document.getElementById('ask-ai-modal');
            const openBtn = document.getElementById('open-ask-ai-modal-btn');
            const closeBtn = document.getElementById('close-ask-ai-modal');
            
            if (openBtn) {
                openBtn.addEventListener('click', () => {
                    modal.classList.remove('hidden');
                    modal.classList.add('flex');
                });
            }

            closeBtn.addEventListener('click', () => modal.classList.add('hidden'));
            modal.addEventListener('click', (e) => { if (e.target === modal) modal.classList.add('hidden'); });

            const sendBtn = document.getElementById('send-ai-question');
            const input = document.getElementById('ai-question-input');

            sendBtn.addEventListener('click', handleGeneralAIQuery);
            input.addEventListener('keypress', (e) => {
                if (e.key === 'Enter') {
                    handleGeneralAIQuery();
                }
            });
        }

        async function handleGeneralAIQuery() {
            const input = document.getElementById('ai-question-input');
            const question = input.value.trim();
            if (!question) return;

            const chatBox = document.getElementById('ai-chat-box');
            const thinkingIndicator = document.getElementById('ai-thinking-indicator');
            const sendBtn = document.getElementById('send-ai-question');
            const inputContainer = document.getElementById('ai-input-container');
            
            const userQuestionHTML = `<div class="flex justify-end"><div class="bg-pink-500 text-white p-3 rounded-lg max-w-xs">${question}</div></div>`;
            chatBox.insertAdjacentHTML('beforeend', userQuestionHTML);
            input.value = '';
            chatBox.scrollTop = chatBox.scrollHeight;

            thinkingIndicator.classList.remove('hidden');
            inputContainer.classList.add('hidden');
            sendBtn.disabled = true;

            const prompt = `You are "UniWhiz," a friendly and knowledgeable AI assistant for a student named Anya who is exploring humanities programs (like PPE, Economics, International Relations) in countries like France, Italy, Singapore, Australia, etc. Based on the provided university data and your general knowledge, answer the following question in a helpful and encouraging tone: "${question}"`;

            try {
                const text = await callGemini(prompt);
                const formattedText = text.replace(/\*\*/g, '<strong>').replace(/\*/g, '</strong>');
                const aiResponseHTML = `<div class="flex justify-start"><div class="bg-gray-200 dark:bg-slate-600 p-3 rounded-lg max-w-xs">${formattedText}</div></div>`;
                chatBox.insertAdjacentHTML('beforeend', aiResponseHTML);
            } catch (error) {
                const errorHTML = `<div class="flex justify-start"><div class="bg-red-100 text-red-700 p-3 rounded-lg max-w-xs">Sorry, I had a little trouble connecting. Please try again!</div></div>`;
                chatBox.insertAdjacentHTML('beforeend', errorHTML);
            } finally {
                thinkingIndicator.classList.add('hidden');
                inputContainer.classList.remove('hidden');
                sendBtn.disabled = false;
                chatBox.scrollTop = chatBox.scrollHeight;
            }
        }
    </script>
</body>
</html>
